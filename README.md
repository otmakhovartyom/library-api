# 🏛️ Library Management API

REST API для управления библиотекой с системой рекомендаций книг. Реализовано на FastAPI с использованием SQLite.

## 🛠 Технологии
- Python 3.10+
- FastAPI
- SQLAlchemy (ORM)
- SQLite
- JWT-аутентификация
- Pydantic (валидация данных)

## 📌 Возможности
- 🔐 Аутентификация по JWT-токенам
- 📚 CRUD-операции для книг, авторов и пользователей
- ⭐ Оценка книг пользователями
- 🧠 Персонализированные рекомендации книг
- 📊 Документация Swagger/ReDoc

## ✅ Соответствие требованиям задания
Проект полностью соответствует всем исходным требованиям:
1. Реализованы CRUD-операции для 3+ связанных сущностей (книги, авторы, пользователи)
2. Настроена JWT-аутентификация с эндпоинтами `/token` и защищенными роутами
3. Реализован алгоритм рекомендаций книг (бизнес-логика)
4. Подключена автоматическая документация Swagger/ReDoc
5. Написаны тесты с использованием TestClient
6. Поддержка SQLite с автоматическим созданием БД при запуске
7. Полностью RESTful API архитектура

## 🧠 Принцип работы рекомендательной системы
Алгоритм рекомендаций использует гибридный подход:
1. **Для новых пользователей**:
   - Рекомендация топ-5 самых популярных книг по среднему рейтингу

2. **Для активных пользователей**:
   - Анализ 3 самых высокооцененных жанров
   - Поиск книг тех же авторов
   - Исключение уже прочитанных книг

3. **Формирование ответа**:
   - Приоритет: книги того же автора > книги того же жанра
   - Сортировка по рейтингу
   - Ограничение по лимиту (по умолчанию 5 книг)

## 🚀 Запуск проекта
1. Клонирование репозитория:
```bash
git clone git@github.com:otmakhovartyom/library-api.git
cd library-api
```

2. Установка зависимостей:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate    # Windows
pip install -r requirements.txt
```

3. Запуск сервера:
```bash
uvicorn main:app --reload
```

Документация:
- Swagger UI: http://127.0.0.1:8000/docs
- ReDoc: http://127.0.0.1:8000/redoc

## 🌐 Основные эндпоинты
| Метод | Путь                     | Описание                          |
|-------|--------------------------|-----------------------------------|
| POST  | /auth/token              | Получение JWT-токена              |
| GET   | /api/v1/books/           | Получить список книг              |
| POST  | /api/v1/books/           | Добавить новую книгу              |
| GET   | /api/v1/recommendations/ | Персонализированные рекомендации  |
| POST  | /api/v1/ratings/         | Оценить книгу                     |

## 🧪 Тестирование
```bash
pytest
```

## 📊 Структура проекта
```
library-api/
├── app
│   ├── main.py
│   ├── config.py
│   ├── models.py
│   ├── schemas.py
│   ├── crud.py
│   ├── auth.py
│   ├── endpoints.py
│   ├── recommendations.py
│   └── database.py
├── test_main.py
├── requirements.txt
└── README.md
```

## ⚠️ Устранение неполадок
При ошибках:
1. Проверьте логи сервера
2. Убедитесь, что БД создана
3. Проверьте JWT-токен

## 📊 Анализ качества кода (Pylint)
Последний отчет pylint:
```text
************* Module auth
auth.py:31:0: C0301: Line too long (121/100) (line-too-long)
auth.py:1:0: C0114: Missing module docstring (missing-module-docstring)
...
------------------------------------
Your code has been rated at 5.40/10
```

Полный отчет:
```bash
pylint *py --output-format=text > pylint_report.txt
```
